(this["webpackJsonpjobly-frontend"]=this["webpackJsonpjobly-frontend"]||[]).push([[0],{142:function(e,a,t){e.exports=t(297)},147:function(e,a,t){},148:function(e,a,t){},156:function(e,a,t){},157:function(e,a,t){},174:function(e,a,t){},175:function(e,a,t){},176:function(e,a,t){},182:function(e,a){},184:function(e,a){},198:function(e,a){},200:function(e,a){},228:function(e,a){},230:function(e,a){},231:function(e,a){},236:function(e,a){},238:function(e,a){},244:function(e,a){},246:function(e,a){},265:function(e,a){},277:function(e,a){},280:function(e,a){},297:function(e,a,t){"use strict";t.r(a);var n=t(0),l=t.n(n),r=t(138),c=t.n(r),s=(t(147),t(6));var o=function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const t=localStorage.getItem(e)||a,[l,r]=Object(n.useState)(t);return Object(n.useEffect)((function(){console.debug("hooks useLocalStorage useEffect","item=",l),null===l?localStorage.removeItem(e):localStorage.setItem(e,l)}),[e,l]),[l,r]};var m=l.a.createContext();t(148);var i=function(e){let{logout:a}=e;const{currentUser:t}=Object(n.useContext)(m);return console.debug("Navigation","currentUser=",t),l.a.createElement("nav",{className:"Navigation navbar navbar-expand-md"},l.a.createElement(s.b,{className:"navbar-brand",to:"/"},"Jobly"),t?l.a.createElement("ul",{className:"navbar-nav ml-auto"},l.a.createElement("li",{className:"nav-item mr-4"},l.a.createElement(s.c,{className:"nav-link",to:"/companies"},"Companies")),l.a.createElement("li",{className:"nav-item mr-4"},l.a.createElement(s.c,{className:"nav-link",to:"/jobs"},"Jobs")),l.a.createElement("li",{className:"nav-item mr-4"},l.a.createElement(s.c,{className:"nav-link",to:"/profile"},"Profile")),l.a.createElement("li",{className:"nav-item"},l.a.createElement(s.b,{className:"nav-link",to:"/",onClick:a},"Log out ",t.first_name||t.username))):l.a.createElement("ul",{className:"navbar-nav ml-auto"},l.a.createElement("li",{className:"nav-item mr-4"},l.a.createElement(s.c,{className:"nav-link",to:"/login"},"Login")),l.a.createElement("li",{className:"nav-item mr-4"},l.a.createElement(s.c,{className:"nav-link",to:"/signup"},"Sign Up"))))},u=t(5);t(156);var p=function(){const{currentUser:e}=Object(n.useContext)(m);return console.debug("Homepage","currentUser=",e),l.a.createElement("div",{className:"Homepage"},l.a.createElement("div",{className:"container text-center"},l.a.createElement("h1",{className:"mb-4 font-weight-bold"},"Jobly"),l.a.createElement("p",{className:"lead"},"All the jobs in one, convenient place."),e?l.a.createElement("h2",null,"Welcome Back, ",e.firstName||e.username,"!"):l.a.createElement("p",null,l.a.createElement(s.b,{className:"btn btn-primary font-weight-bold mr-3",to:"/login"},"Log in"),l.a.createElement(s.b,{className:"btn btn-primary font-weight-bold",to:"/signup"},"Sign up"))))};t(157);var d=function(e){let{searchFor:a}=e;console.debug("SearchForm","searchFor=",typeof a);const[t,r]=Object(n.useState)("");return l.a.createElement("div",{className:"SearchForm mb-4"},l.a.createElement("form",{className:"form-inline",onSubmit:function(e){e.preventDefault(),a(t.trim()||void 0),r(t.trim())}},l.a.createElement("input",{className:"form-control form-control-lg flex-grow-1",name:"searchTerm",placeholder:"Enter search term..",value:t,onChange:function(e){r(e.target.value)}}),l.a.createElement("button",{type:"submit",className:"btn btn-lg btn-primary"},"Submit")))},f=t(140),E=t.n(f);class g{static async request(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"get";console.debug("API Call:",e,a,t);const n="".concat("https://job-back-lqce.onrender.com","/").concat(e),l={Authorization:"Bearer ".concat(g.token)},r="get"===t?a:{};try{return(await E()({url:n,method:t,data:a,params:r,headers:l})).data}catch(c){console.error("API Error:",c.response);let e=c.response.data.error.message;throw Array.isArray(e)?e:[e]}}static async getCurrentUser(e){return(await this.request("users/".concat(e))).user}static async getCompanies(e){return(await this.request("companies",{name:e})).companies}static async getCompany(e){return(await this.request("companies/".concat(e))).company}static async getJobs(e){return(await this.request("jobs",{title:e})).jobs}static async applyToJob(e,a){await this.request("users/".concat(e,"/jobs/").concat(a),{},"post")}static async login(e){return(await this.request("auth/token",e,"post")).token}static async signup(e){return(await this.request("auth/register",e,"post")).token}static async saveProfile(e,a){return(await this.request("users/".concat(e),a,"patch")).user}}var b=g;t(174);var v=function(e){let{name:a,description:t,logoUrl:n,handle:r}=e;return console.debug("CompanyCard",n),l.a.createElement(s.b,{className:"CompanyCard card",to:"/companies/".concat(r)},l.a.createElement("div",{className:"card-body"},l.a.createElement("h6",{className:"card-title"},a,n&&l.a.createElement("img",{src:n,alt:a,className:"float-right ml-5"})),l.a.createElement("p",null,l.a.createElement("small",null,t))))};t(175);var N=function(){return l.a.createElement("div",{className:"LoadingSpinner"},"Loading ...")};var h=function(){console.debug("CompanyList");const[e,a]=Object(n.useState)(null);async function t(e){let t=await b.getCompanies(e);a(t)}return Object(n.useEffect)((function(){console.debug("CompanyList useEffect getCompaniesOnMount"),t()}),[]),e?l.a.createElement("div",{className:"CompanyList col-md-8 offset-md-2"},l.a.createElement(d,{searchFor:t}),e.length?l.a.createElement("div",{className:"CompanyList-list"},e.map(e=>l.a.createElement(v,{key:e.handle,handle:e.handle,name:e.name,description:e.description,logoUrl:e.logoUrl}))):l.a.createElement("p",{className:"lead"},"Sorry, no results were found!")):l.a.createElement(N,null)};t(176);var y=function(e){let{id:a,title:t,salary:r,equity:c,companyName:s}=e;console.debug("JobCard");const{hasAppliedToJob:o,applyToJob:i}=Object(n.useContext)(m),[u,p]=Object(n.useState)();return l.a.useEffect((function(){console.debug("JobCard useEffect updateAppliedStatus","id=",a),p(o(a))}),[a,o]),l.a.createElement("div",{className:"JobCard card"}," ",u,l.a.createElement("div",{className:"card-body"},l.a.createElement("h6",{className:"card-title"},t),l.a.createElement("p",null,s),r&&l.a.createElement("div",null,l.a.createElement("small",null,"Salary: ",function(e){const a=[],t=e.toString();for(let n=t.length-1;n>=0;n--)a.push(t[n]),n>0&&n%3===0&&a.push(",");return a.reverse().join("")}(r))),void 0!==c&&l.a.createElement("div",null,l.a.createElement("small",null,"Equity: ",c)),l.a.createElement("button",{className:"btn btn-danger font-weight-bold text-uppercase float-right",onClick:async function(e){o(a)||(i(a),p(!0))},disabled:u},u?"Applied":"Apply")))};var w=function(e){let{jobs:a,apply:t}=e;return console.debug("JobCardList","jobs=",a),l.a.createElement("div",{className:"JobCardList"},a.map(e=>l.a.createElement(y,{key:e.id,id:e.id,title:e.title,salary:e.salary,equity:e.equity,companyName:e.companyName})))};var C=function(){console.debug("JobList");const[e,a]=Object(n.useState)(null);async function t(e){let t=await b.getJobs(e);a(t)}return Object(n.useEffect)((function(){console.debug("JobList useEffect getAllJobsOnMount"),t()}),[]),e?l.a.createElement("div",{className:"JobList col-md-8 offset-md-2"},l.a.createElement(d,{searchFor:t}),e.length?l.a.createElement(w,{jobs:e}):l.a.createElement("p",{className:"lead"},"Sorry, no results were found!")):l.a.createElement(N,null)};var j=function(){const{handle:e}=Object(u.h)();console.debug("CompanyDetail","handle=",e);const[a,t]=Object(n.useState)(null);return Object(n.useEffect)((function(){!async function(){t(await b.getCompany(e))}()}),[e]),a?l.a.createElement("div",{className:"CompanyDetail col-md-8 offset-md-2"},l.a.createElement("h4",null,a.name),l.a.createElement("p",null,a.description),l.a.createElement(w,{jobs:a.jobs})):l.a.createElement(N,null)};var S=function(e){let{type:a="danger",messages:t=[]}=e;return console.debug("Alert","type=",a,"messages=",t),l.a.createElement("div",{className:"alert alert-".concat(a),role:"alert"},t.map(e=>l.a.createElement("p",{className:"mb-0 small",key:e},e)))};var O=function(e){let{login:a}=e;const t=Object(u.g)(),[r,c]=Object(n.useState)({username:"",password:""}),[s,o]=Object(n.useState)([]);async function m(e){e.preventDefault();let n=await a(r);n.success?t.push("/companies"):o(n.errors)}function i(e){const{name:a,value:t}=e.target;c(e=>({...e,[a]:t}))}return console.debug("LoginForm","login=",typeof a,"formData=",r,"formErrors",s),l.a.createElement("div",{className:"LoginForm"},l.a.createElement("div",{className:"container col-md-6 offset-md-3 col-lg-4 offset-lg-4"},l.a.createElement("h3",{className:"mb-3"},"Log In"),l.a.createElement("div",{className:"card"},l.a.createElement("div",{className:"card-body"},l.a.createElement("form",{onSubmit:m},l.a.createElement("div",{className:"form-group"},l.a.createElement("label",null,"Username"),l.a.createElement("input",{name:"username",className:"form-control",value:r.username,onChange:i,autoComplete:"username",required:!0})),l.a.createElement("div",{className:"form-group"},l.a.createElement("label",null,"Password"),l.a.createElement("input",{type:"password",name:"password",className:"form-control",value:r.password,onChange:i,autoComplete:"current-password",required:!0})),s.length?l.a.createElement(S,{type:"danger",messages:s}):null,l.a.createElement("button",{className:"btn btn-primary float-right",onSubmit:m},"Submit"))))))};var k=function(){const{currentUser:e,setCurrentUser:a}=Object(n.useContext)(m),[t,r]=Object(n.useState)({firstName:e.firstName,lastName:e.lastName,email:e.email,username:e.username,password:""}),[c,s]=Object(n.useState)([]),[o,i]=Object(n.useState)(!1);function u(e){const{name:a,value:t}=e.target;r(e=>({...e,[a]:t})),s([])}return console.debug("ProfileForm","currentUser=",e,"formData=",t,"formErrors=",c,"saveConfirmed=",o),l.a.createElement("div",{className:"col-md-6 col-lg-4 offset-md-3 offset-lg-4"},l.a.createElement("h3",null,"Profile"),l.a.createElement("div",{className:"card"},l.a.createElement("div",{className:"card-body"},l.a.createElement("form",null,l.a.createElement("div",{className:"form-group"},l.a.createElement("label",null,"Username"),l.a.createElement("p",{className:"form-control-plaintext"},t.username)),l.a.createElement("div",{className:"form-group"},l.a.createElement("label",null,"First Name"),l.a.createElement("input",{name:"firstName",className:"form-control",value:t.firstName,onChange:u})),l.a.createElement("div",{className:"form-group"},l.a.createElement("label",null,"Last Name"),l.a.createElement("input",{name:"lastName",className:"form-control",value:t.lastName,onChange:u})),l.a.createElement("div",{className:"form-group"},l.a.createElement("label",null,"Email"),l.a.createElement("input",{name:"email",className:"form-control",value:t.email,onChange:u})),l.a.createElement("div",{className:"form-group"},l.a.createElement("label",null,"Confirm password to make changes:"),l.a.createElement("input",{type:"password",name:"password",className:"form-control",value:t.password,onChange:u})),c.length?l.a.createElement(S,{type:"danger",messages:c}):null,o?l.a.createElement(S,{type:"success",messages:["Updated successfully."]}):null,l.a.createElement("button",{className:"btn btn-primary btn-block mt-4",onClick:async function(e){e.preventDefault();let n,l={firstName:t.firstName,lastName:t.lastName,email:t.email,password:t.password},c=t.username;try{n=await b.saveProfile(c,l)}catch(o){return void s(o)}r(e=>({...e,password:""})),s([]),i(!0),a(n)}},"Save Changes")))))};var U=function(e){let{signup:a}=e;const t=Object(u.g)(),[r,c]=Object(n.useState)({username:"",password:"",firstName:"",lastName:"",email:""}),[s,o]=Object(n.useState)([]);async function m(e){e.preventDefault();let n=await a(r);n.success?t.push("/companies"):o(n.errors)}function i(e){const{name:a,value:t}=e.target;c(e=>({...e,[a]:t}))}return console.debug("SignupForm","signup=",typeof a,"formData=",r,"formErrors=",s),l.a.createElement("div",{className:"SignupForm"},l.a.createElement("div",{className:"container col-md-6 offset-md-3 col-lg-4 offset-lg-4"},l.a.createElement("h2",{className:"mb-3"},"Sign Up"),l.a.createElement("div",{className:"card"},l.a.createElement("div",{className:"card-body"},l.a.createElement("form",{onSubmit:m},l.a.createElement("div",{className:"form-group"},l.a.createElement("label",null,"Username"),l.a.createElement("input",{name:"username",className:"form-control",value:r.username,onChange:i})),l.a.createElement("div",{className:"form-group"},l.a.createElement("label",null,"Password"),l.a.createElement("input",{type:"password",name:"password",className:"form-control",value:r.password,onChange:i})),l.a.createElement("div",{className:"form-group"},l.a.createElement("label",null,"First name"),l.a.createElement("input",{name:"firstName",className:"form-control",value:r.firstName,onChange:i})),l.a.createElement("div",{className:"form-group"},l.a.createElement("label",null,"Last name"),l.a.createElement("input",{name:"lastName",className:"form-control",value:r.lastName,onChange:i})),l.a.createElement("div",{className:"form-group"},l.a.createElement("label",null,"Email"),l.a.createElement("input",{type:"email",name:"email",className:"form-control",value:r.email,onChange:i})),s.length?l.a.createElement(S,{type:"danger",messages:s}):null,l.a.createElement("button",{type:"submit",className:"btn btn-primary float-right",onSubmit:m},"Submit"))))))};var J=function(e){let{exact:a,path:t,children:r}=e;const{currentUser:c}=Object(n.useContext)(m);return console.debug("PrivateRoute","exact=",a,"path=",t,"currentUser=",c),c?l.a.createElement(u.b,{exact:a,path:t},r):l.a.createElement(u.a,{to:"/login"})};var x=function(e){let{login:a,signup:t}=e;return console.debug("Routes","login=".concat(typeof a),"register=".concat(typeof register)),l.a.createElement("div",{className:"pt-5"},l.a.createElement(u.d,null,l.a.createElement(u.b,{exact:!0,path:"/"},l.a.createElement(p,null)),l.a.createElement(u.b,{exact:!0,path:"/login"},l.a.createElement(O,{login:a})),l.a.createElement(u.b,{exact:!0,path:"/signup"},l.a.createElement(U,{signup:t})),l.a.createElement(J,{exact:!0,path:"/companies"},l.a.createElement(h,null)),l.a.createElement(J,{exact:!0,path:"/jobs"},l.a.createElement(C,null)),l.a.createElement(J,{exact:!0,path:"/companies/:handle"},l.a.createElement(j,null)),l.a.createElement(J,{path:"/profile"},l.a.createElement(k,null)),l.a.createElement(u.a,{to:"/"})))},L=t(141),A=t.n(L);var q=function(){const[e,a]=Object(n.useState)(!1),[t,r]=Object(n.useState)(new Set([])),[c,u]=Object(n.useState)(null),[p,d]=o("jobly-token");function f(e){return t.has(e)}return console.debug("App","infoLoaded=",e,"currentUser=",c,"token=",p),Object(n.useEffect)((function(){console.debug("App useEffect loadUserInfo","token=",p),a(!1),async function(){if(p)try{let{username:e}=A.a.decode(p);b.token=p;let a=await b.getCurrentUser(e);u(a),r(new Set(a.applications))}catch(e){console.error("App loadUserInfo: problem loading",e),u(null)}a(!0)}()}),[p]),e?l.a.createElement(s.a,null,l.a.createElement(m.Provider,{value:{currentUser:c,setCurrentUser:u,hasAppliedToJob:f,applyToJob:function(e){f(e)||(b.applyToJob(c.username,e),r(new Set([...t,e])))}}},l.a.createElement("div",{className:"App"},l.a.createElement(i,{logout:function(){u(null),d(null)}}),l.a.createElement(x,{login:async function(e){try{let a=await b.login(e);return d(a),{success:!0}}catch(a){return console.error("login failed",a),{success:!1,errors:a}}},signup:async function(e){try{let a=await b.signup(e);return d(a),{success:!0}}catch(a){return console.error("signup failed",a),{success:!1,errors:a}}}})))):l.a.createElement(N,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(l.a.createElement(q,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(e=>{e.unregister()}).catch(e=>{console.error(e.message)})}},[[142,1,2]]]);
//# sourceMappingURL=main.68cb3a00.chunk.js.map